# 自动座位分配系统

## 项目简介

自动座位分配系统是一个基于Python和Qt框架开发的图形化工具，用于根据学生成绩和座位关系自动分配教室座位。系统支持两种分配策略：成绩分层法和分组均匀分配法，可根据用户需求灵活配置。

## 功能特性

### 1. 用户界面
- 直观友好的图形用户界面，基于PyQt5开发
- 支持Excel文件拖放导入
- 清晰的座位分配结果可视化展示
- 支持缩放和拖拽调整的座位图
- 详细的学生信息悬停提示

### 2. 数据处理
- 支持Excel格式(.xlsx, .xls)文件导入
- 数据验证和错误提示
- 学生成绩排序与分类
- 座位关系规则管理

### 3. 座位分配算法
- **成绩分层法**：根据成绩分层分配座位，确保同层次学生均匀分布
- **分组均匀分配法**：随机分组，确保各组成绩均衡
- 支持座位关系规则优先处理
- 支持教室布局自定义配置

### 4. 结果导出
- 支持导出为Excel格式，包含详细座位信息
- 支持导出为PNG/JPG图片格式，分辨率不低于300dpi

## 技术栈

- **编程语言**：Python 3.8+
- **UI框架**：PyQt5 5.15.10
- **数据处理**：pandas 2.0.3, numpy 1.24.3
- **Excel处理**：openpyxl 3.1.2
- **可选可视化**：matplotlib 3.7.2, PyQtGraph 0.13.3
- **打包工具**：PyInstaller 5.13.0

## 安装与使用

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行系统

```bash
python src/main.py
```

### 3. 使用流程

1. **导入成绩**：点击"导入成绩"按钮，选择Excel文件导入学生成绩数据
2. **配置座位**：点击"配置座位"按钮，设置必须坐在一起和不能坐在一起的学生关系
3. **开始分配**：点击"开始分配"按钮，选择分配算法和参数
4. **查看结果**：在"结果查看"标签页查看座位分配结果
5. **导出结果**：点击"导出结果"按钮，选择导出格式保存结果

## 项目结构

```
class-helper/
├── src/                  # 源代码目录
│   ├── ui/               # 用户界面模块
│   ├── core/             # 核心功能模块
│   ├── utils/            # 工具模块
│   └── main.py           # 应用入口
├── resources/            # 资源目录
│   ├── templates/        # 教室布局模板
│   └── icons/            # 图标资源
├── tests/                # 测试目录
├── examples/             # 示例数据
├── requirements.txt      # 依赖库
└── README.md             # 项目说明
```

## 教室布局模板

系统内置三种教室布局模板：
- **标准教室**：8行6列，包含两条过道
- **小班教室**：6行5列，包含一条过道
- **大教室**：10行8列，包含两条过道

用户也可以自定义教室布局，设置行数、列数和过道位置。

## 常见问题

### 1. 导入Excel文件失败
- 检查文件格式是否正确（.xlsx或.xls）
- 检查文件是否包含必要的列（姓名、学号）
- 检查文件是否被其他程序占用

### 2. 座位分配结果不符合预期
- 检查座位关系规则是否正确设置
- 尝试调整算法参数
- 检查教室布局是否合适

### 3. 导出图片质量不佳
- 系统默认导出分辨率为300dpi，可在配置文件中调整
- 确保导出路径有足够的写入权限

## 配置文件

系统配置文件位于 `resources/config.json`，可根据需要修改配置参数。

## 许可证

本项目采用 MIT 许可证。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！
